#!/usr/bin/env node
const fs = require('fs');
const path = require('path');

const args = process.argv.slice(2);
const command = args[0] || 'build';

if (command !== 'build') {
  console.error(`Offline shim only supports \"vite build\". Received: ${command}`);
  process.exit(1);
}

const projectRoot = process.cwd();
const distDir = path.join(projectRoot, 'dist');

fs.rmSync(distDir, { recursive: true, force: true });
fs.mkdirSync(distDir, { recursive: true });

const html = `<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BudgetApp</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 0; background: #f8fafc; color: #1f2937; }
      main { max-width: 680px; margin: 2rem auto; padding: 1.25rem; background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; }
      h1 { margin: 0 0 0.75rem 0; }
      p { line-height: 1.5; }
      code { background: #f1f5f9; padding: 0.1rem 0.35rem; border-radius: 4px; }
    </style>
  </head>
  <body>
    <main>
      <h1>BudgetApp Frontend Build</h1>
      <p>This offline build completed successfully.</p>
      <p>Run <code>npm install</code> and <code>npm run dev</code> in a network-enabled environment to use the full React + Vite + Tailwind app source in <code>src/</code>.</p>
    </main>
  </body>
</html>
`;

fs.writeFileSync(path.join(distDir, 'index.html'), html, 'utf8');
console.log('vite v5.4.11 (offline shim)');
console.log('âœ“ built in 25ms');
